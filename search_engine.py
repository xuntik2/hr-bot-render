–ü–û–ò–°–ö–û–í–´–ô –î–í–ò–ñ–û–ö –î–õ–Ø HR-–ë–û–¢–ê –ú–ï–ß–ï–õ
–í–µ—Ä—Å–∏—è 5.0 ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ —Ç–∞—Ä–∏—Ñ–∞:
- –ò–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω–¥–µ–∫—Å (O(1) –¥–æ—Å—Ç—É–ø –∫ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞–º)
- TF‚ÄëIDF —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ë—ã—Å—Ç—Ä—ã–π –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω —Å –ø–æ—Ä–æ–≥–æ–º
- –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Å–∏–Ω–æ–Ω–∏–º—ã (>250 –∑–∞–ø–∏—Å–µ–π)
- –£–º–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —á–∏—Å–ª–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
- –ö—ç—à —Å TTL 30 –º–∏–Ω—É—Ç
"""

import logging
import json
import os
import re
import hashlib
import math
from typing import List, Optional, Tuple, Dict, Any, Set
from dataclasses import dataclass
from collections import OrderedDict, defaultdict
from datetime import datetime, timedelta

logger = logging.getLogger(__name__)

# ------------------------------------------------------------
#  –§–£–ù–ö–¶–ò–Ø –õ–ï–í–ï–ù–®–¢–ï–ô–ù–ê –° –ü–û–†–û–ì–û–ú
# ------------------------------------------------------------
def levenshtein_distance(s1: str, s2: str, threshold: int = None) -> int:
    """
    –í—ã—á–∏—Å–ª—è–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Ä–∞–Ω–Ω–µ–≥–æ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è,
    –µ—Å–ª–∏ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ø–æ—Ä–æ–≥.
    """
    if s1 == s2:
        return 0
    if len(s1) < len(s2):
        return levenshtein_distance(s2, s1, threshold)
    if len(s2) == 0:
        return len(s1)

    if threshold is None:
        threshold = max(len(s1), len(s2))

    # –ï—Å–ª–∏ —Ä–∞–∑–Ω–∏—Ü–∞ –¥–ª–∏–Ω –±–æ–ª—å—à–µ –ø–æ—Ä–æ–≥–∞, —Å—Ä–∞–∑—É –≤–æ–∑–≤—Ä–∞—â–∞–µ–º > –ø–æ—Ä–æ–≥–∞
    if len(s1) - len(s2) > threshold:
        return threshold + 1

    previous_row = list(range(len(s2) + 1))
    for i, c1 in enumerate(s1):
        current_row = [i + 1]
        # –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –≤ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–µ
        min_current = i + 1
        for j, c2 in enumerate(s2):
            insertions = previous_row[j + 1] + 1
            deletions = current_row[j] + 1
            substitutions = previous_row[j] + (c1 != c2)
            cost = min(insertions, deletions, substitutions)
            current_row.append(cost)
            if cost < min_current:
                min_current = cost
        # –ï—Å–ª–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –≤ —Å—Ç—Ä–æ–∫–µ —É–∂–µ –ø—Ä–µ–≤—ã—Å–∏–ª–æ –ø–æ—Ä–æ–≥ ‚Äî –ø—Ä–µ—Ä—ã–≤–∞–µ–º
        if min_current > threshold:
            return threshold + 1
        previous_row = current_row
    return previous_row[-1]


@dataclass
class FAQEntry:
    id: int
    question: str
    answer: str
    keywords: str
    norm_keywords: str
    norm_question: str
    category: str
    usage_count: int = 0


class SearchEngine:
    """
    –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–∏—Å–∫–æ–≤—ã–π –¥–≤–∏–∂–æ–∫ —Å –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∏–Ω–¥–µ–∫—Å–æ–º,
    TF‚ÄëIDF, –ø–æ—Ä–æ–≥–æ–≤—ã–º –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–æ–º –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ —Å–∏–Ω–æ–Ω–∏–º–∞–º–∏.
    """

    # --------------------------------------------------------
    #  –†–ê–°–®–ò–†–ï–ù–ù–´–ô –°–õ–û–í–ê–†–¨ –°–ò–ù–û–ù–ò–ú–û–í (–±–æ–ª–µ–µ 250 –∑–∞–ø–∏—Å–µ–π)
    # --------------------------------------------------------
    SYNONYMS = {
        # ---------- –û–¢–ü–£–°–ö ----------
        '–æ—Ç–ø—É—Å–∫ –ø–æ —É—Ö–æ–¥—É –∑–∞ —Ä–µ–±–µ–Ω–∫–æ–º': '–æ—Ç–ø—É—Å–∫ –ø–æ —É—Ö–æ–¥—É –∑–∞ —Ä–µ–±–µ–Ω–∫–æ–º',
        '–æ—Ç–ø—É—Å–∫ –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞—Ä–ø–ª–∞—Ç—ã': '–æ—Ç–ø—É—Å–∫ –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞—Ä–ø–ª–∞—Ç—ã',
        '–µ–∂–µ–≥–æ–¥–Ω—ã–π –æ–ø–ª–∞—á–∏–≤–∞–µ–º—ã–π –æ—Ç–ø—É—Å–∫': '–æ—Ç–ø—É—Å–∫',
        '–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ—Ç–ø—É—Å–∫': '–æ—Ç–ø—É—Å–∫ –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞—Ä–ø–ª–∞—Ç—ã',
        '–Ω–µ–æ–ø–ª–∞—á–∏–≤–∞–µ–º—ã–π –æ—Ç–ø—É—Å–∫': '–æ—Ç–ø—É—Å–∫ –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞—Ä–ø–ª–∞—Ç—ã',
        '–∑–∞ —Å–≤–æ–π —Å—á–µ—Ç': '–æ—Ç–ø—É—Å–∫ –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞—Ä–ø–ª–∞—Ç—ã',
        '–æ—Ç–ø—É—Å–∫ –∞–≤–∞–Ω—Å–æ–º': '–æ—Ç–ø—É—Å–∫ –¥–æ 6 –º–µ—Å—è—Ü–µ–≤',
        '–¥–æ—Å—Ä–æ—á–Ω—ã–π –æ—Ç–ø—É—Å–∫': '–æ—Ç–ø—É—Å–∫ –¥–æ 6 –º–µ—Å—è—Ü–µ–≤',
        '–æ—Ç–ø—É—Å–∫ –Ω–∞ —Å–µ—Å—Å–∏—é': '—É—á–µ–±–Ω—ã–π –æ—Ç–ø—É—Å–∫',
        '–¥–µ–∫—Ä–µ—Ç–Ω—ã–π –æ—Ç–ø—É—Å–∫': '–æ—Ç–ø—É—Å–∫ –ø–æ —É—Ö–æ–¥—É –∑–∞ —Ä–µ–±–µ–Ω–∫–æ–º',
        '–¥–µ—Ç—Å–∫–∏–π –æ—Ç–ø—É—Å–∫': '–æ—Ç–ø—É—Å–∫ –ø–æ —É—Ö–æ–¥—É –∑–∞ —Ä–µ–±–µ–Ω–∫–æ–º',
        '–æ—Ç–ø—É—Å–∫–Ω—ã–µ –≤—ã–ø–ª–∞—Ç—ã': '–æ—Ç–ø—É—Å–∫',
        '–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –æ—Ç–ø—É—Å–∫–∞': '—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ',
        '–æ—Ç–¥—ã—Ö': '–æ—Ç–ø—É—Å–∫',
        '–¥–µ–∫—Ä–µ—Ç': '–æ—Ç–ø—É—Å–∫ –ø–æ —É—Ö–æ–¥—É –∑–∞ —Ä–µ–±–µ–Ω–∫–æ–º',
        '—Å–µ—Å—Å–∏—è': '—É—á–µ–±–Ω—ã–π –æ—Ç–ø—É—Å–∫',
        '—É—á–µ–±–∞': '—É—á–µ–±–Ω—ã–π –æ—Ç–ø—É—Å–∫',
        '–æ—Ç–≥—É–ª': '–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –≤—ã—Ö–æ–¥–Ω–æ–π',
        '–∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∞': '—Å–ª—É–∂–µ–±–Ω–∞—è –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∞',

        # ---------- –ë–û–õ–¨–ù–ò–ß–ù–´–ï ----------
        '–ª–∏—Å—Ç–æ–∫ –Ω–µ—Ç—Ä—É–¥–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏': '–±–æ–ª—å–Ω–∏—á–Ω—ã–π –ª–∏—Å—Ç',
        '—ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–π –±–æ–ª—å–Ω–∏—á–Ω—ã–π': '–±–æ–ª—å–Ω–∏—á–Ω—ã–π –ª–∏—Å—Ç',
        '–æ–ø–ª–∞—Ç–∞ –±–æ–ª—å–Ω–∏—á–Ω–æ–≥–æ': '–±–æ–ª—å–Ω–∏—á–Ω—ã–π –ª–∏—Å—Ç',
        '—Ä–∞—Å—á–µ—Ç –±–æ–ª—å–Ω–∏—á–Ω–æ–≥–æ': '–±–æ–ª—å–Ω–∏—á–Ω—ã–π –ª–∏—Å—Ç',
        '–±–æ–ª—å–Ω–∏—á–Ω—ã–π –ª–∏—Å—Ç': '–±–æ–ª—å–Ω–∏—á–Ω—ã–π –ª–∏—Å—Ç',
        '–Ω–µ—Ç—Ä—É–¥–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å': '–±–æ–ª—å–Ω–∏—á–Ω—ã–π –ª–∏—Å—Ç',
        '—ç–ª–Ω': '–±–æ–ª—å–Ω–∏—á–Ω—ã–π –ª–∏—Å—Ç',
        '–±/–ª': '–±–æ–ª—å–Ω–∏—á–Ω—ã–π –ª–∏—Å—Ç',

        # ---------- –ó–ê–†–ü–õ–ê–¢–ê –ò –ü–†–ï–ú–ò–ò ----------
        '–≥–æ–¥–æ–≤–∞—è –ø—Ä–µ–º–∏—è': '–ø—Ä–µ–º–∏—è –ø–æ –∏—Ç–æ–≥–∞–º –≥–æ–¥–∞',
        '13 –∑–∞—Ä–ø–ª–∞—Ç–∞': '–ø—Ä–µ–º–∏—è –ø–æ –∏—Ç–æ–≥–∞–º –≥–æ–¥–∞',
        '–∑–∞—Ä–∞–±–æ—Ç–Ω–∞—è –ø–ª–∞—Ç–∞': '–∑–∞—Ä–ø–ª–∞—Ç–∞',
        '–ø–æ–ª—É—á–∫–∞': '–∑–∞—Ä–ø–ª–∞—Ç–∞',
        '–∞–≤–∞–Ω—Å': '–∑–∞—Ä–ø–ª–∞—Ç–∞',
        '–æ–∫–ª–∞–¥': '–∑–∞—Ä–ø–ª–∞—Ç–∞',
        '–∑–ø': '–∑–∞—Ä–ø–ª–∞—Ç–∞',
        '–ø—Ä–µ–º–∏–∞–ª—å–Ω—ã–µ': '–ø—Ä–µ–º–∏—è',
        '–±–æ–Ω—É—Å': '–ø—Ä–µ–º–∏—è',
        '–∫13': '–ø—Ä–µ–º–∏—è –ø–æ –∏—Ç–æ–≥–∞–º –≥–æ–¥–∞',

        # ---------- –¢–†–£–î–û–£–°–¢–†–û–ô–°–¢–í–û –ò –ö–ê–î–†–´ ----------
        '–ø—Ä–∏–µ–º –Ω–∞ —Ä–∞–±–æ—Ç—É': '–¥–æ–∫—É–º–µ–Ω—Ç—ã –ø—Ä–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ',
        '—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–∞ —Ä–∞–±–æ—Ç—É': '–¥–æ–∫—É–º–µ–Ω—Ç—ã –ø—Ä–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ',
        '–∑–∞—è–≤–ª–µ–Ω–∏–µ –æ–± —É–≤–æ–ª—å–Ω–µ–Ω–∏–∏': '—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ',
        '—Ä–∞—Å—á–µ—Ç –ø—Ä–∏ —É–≤–æ–ª—å–Ω–µ–Ω–∏–∏': '—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ',
        '—É–≤–æ–ª–∏—Ç—å—Å—è': '—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ',
        '—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ': '—Ä–∞—Å—á–µ—Ç',
        '–∏—Å–ø—ã—Ç–∞—Ç–µ–ª—å–Ω—ã–π —Å—Ä–æ–∫': '—Å—Ç–∞–∂–∏—Ä–æ–≤–∫–∞',
        '—Å—Ç–∞–∂–∏—Ä–æ–≤–∫–∞': '–∏—Å–ø—ã—Ç–∞—Ç–µ–ª—å–Ω—ã–π —Å—Ä–æ–∫',
        '—Ç—Ä—É–¥–æ–≤–∞—è –∫–Ω–∏–∂–∫–∞': '—Ç—Ä—É–¥–æ–≤–∞—è –∫–Ω–∏–∂–∫–∞',
        '—ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è —Ç—Ä—É–¥–æ–≤–∞—è': '—ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è —Ç—Ä—É–¥–æ–≤–∞—è –∫–Ω–∏–∂–∫–∞',
        '—ç—Ç–∫': '—ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è —Ç—Ä—É–¥–æ–≤–∞—è –∫–Ω–∏–∂–∫–∞',
        '—Ç—Ä—É–¥–æ–≤–∞—è': '—Ç—Ä—É–¥–æ–≤–∞—è –∫–Ω–∏–∂–∫–∞',
        '–æ—Ç–¥–µ–ª –∫–∞–¥—Ä–æ–≤': '–æ—Ç–¥–µ–ª –∫–∞–¥—Ä–æ–≤',
        '–∫–∞–¥—Ä—ã': '–æ—Ç–¥–µ–ª –∫–∞–¥—Ä–æ–≤',
        '–ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ': '–∏–∑–º–µ–Ω–∏—Ç—å –ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ',
        '–∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ñ–∞–º–∏–ª–∏–∏': '–∏–∑–º–µ–Ω–∏—Ç—å –ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ',
        '—Å–º–µ–Ω–∞ –ø–∞—Å–ø–æ—Ä—Ç–∞': '–∏–∑–º–µ–Ω–∏—Ç—å –ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ',
        '–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–∏': '–∫–∞—Ä—å–µ—Ä–Ω—ã–π —Ä–æ—Å—Ç',
        '–∫–∞—Ä—å–µ—Ä–∞': '–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–∏',
        '–ø–æ–≤—ã—à–µ–Ω–∏–µ': '–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–∏',
        '–ø–µ—Ä–µ–≤–æ–¥': '–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–∏',
        '–≤–∞–∫–∞–Ω—Å–∏—è': '–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–∏',

        # ---------- –û–•–†–ê–ù–ê –¢–†–£–î–ê ----------
        '—Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —É—Å–ª–æ–≤–∏–π —Ç—Ä—É–¥–∞': '—Å–æ—É—Ç',
        '—Å—Ä–µ–¥—Å—Ç–≤–∞ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–π –∑–∞—â–∏—Ç—ã': '—Å–∏–∑',
        '–≤—Ä–µ–¥–Ω—ã–µ —É—Å–ª–æ–≤–∏—è —Ç—Ä—É–¥–∞': '–≤—Ä–µ–¥–Ω—ã–µ —É—Å–ª–æ–≤–∏—è —Ç—Ä—É–¥–∞',
        '–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –º–µ–¥–æ—Å–º–æ—Ç—Ä': '–º–µ–¥–æ—Å–º–æ—Ç—Ä',
        '–ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π –º–µ–¥–æ—Å–º–æ—Ç—Ä': '–º–µ–¥–æ—Å–º–æ—Ç—Ä',
        '–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –º–µ–¥–æ—Å–º–æ—Ç—Ä': '–º–µ–¥–æ—Å–º–æ—Ç—Ä',
        '—Ç–µ—Ö–Ω–∏–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏': '–æ—Ö—Ä–∞–Ω–∞ —Ç—Ä—É–¥–∞',
        '–ø–æ–∂–∞—Ä–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å': '–ø–æ–∂–∞—Ä',
        '–º–æ–ª–æ–∫–æ –∑–∞ –≤—Ä–µ–¥–Ω–æ—Å—Ç—å': '–≤—Ä–µ–¥–Ω—ã–µ —É—Å–ª–æ–≤–∏—è —Ç—Ä—É–¥–∞',
        '–¥–æ–ø–ª–∞—Ç–∞ –∑–∞ –≤—Ä–µ–¥–Ω–æ—Å—Ç—å': '–≤—Ä–µ–¥–Ω—ã–µ —É—Å–ª–æ–≤–∏—è —Ç—Ä—É–¥–∞',
        '—Å–æ–∫—Ä–∞—â–µ–Ω–Ω—ã–π –¥–µ–Ω—å': '–≤—Ä–µ–¥–Ω—ã–µ —É—Å–ª–æ–≤–∏—è —Ç—Ä—É–¥–∞',
        '—Å—É–µ—Ç': '—Å–æ—É—Ç',
        '—Å–æ—É—Ç': '—Å–æ—É—Ç',
        '—Å–ø–µ—Ü–æ—Ü–µ–Ω–∫–∞': '—Å–æ—É—Ç',
        '—Å–ø–µ—Ü–æ–¥–µ–∂–¥–∞': '—Å–∏–∑',
        '—Å–ø–µ—Ü–æ–±—É–≤—å': '—Å–∏–∑',
        '–∫–∞—Å–∫–∞': '—Å–∏–∑',
        '–±–µ—Ä—É—à–∏': '—Å–∏–∑',
        '—Å–∏–∑': '—Å–∏–∑',
        '–º–µ–¥–∫–æ–º–∏—Å—Å–∏—è': '–º–µ–¥–æ—Å–º–æ—Ç—Ä',
        '–ø—Ä–æ—Ñ–æ—Å–º–æ—Ç—Ä': '–º–µ–¥–æ—Å–º–æ—Ç—Ä',
        '–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π –æ—Å–º–æ—Ç—Ä': '–º–µ–¥–æ—Å–º–æ—Ç—Ä',
        '—ç–≤–∞–∫—É–∞—Ü–∏—è': '–ø–æ–∂–∞—Ä',
        '–æ–≥–Ω–µ—Ç—É—à–∏—Ç–µ–ª—å': '–ø–æ–∂–∞—Ä',

        # ---------- –ö–û–†–ü–û–†–ê–¢–ò–í–ù–ê–Ø –ö–£–õ–¨–¢–£–†–ê ----------
        '–¥–µ–Ω—å –º–µ—Ç–∞–ª–ª—É—Ä–≥–∞': '–¥–µ–Ω—å –º–µ—Ç–∞–ª–ª—É—Ä–≥–∞',
        '–¥–µ–Ω—å —à–∞—Ö—Ç–µ—Ä–∞': '–¥–µ–Ω—å —à–∞—Ö—Ç–µ—Ä–∞',
        '–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è': '–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è',
        '–Ω–µ—Ä–∞–±–æ—á–∏–µ –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–µ –¥–Ω–∏': '–ø—Ä–∞–∑–¥–Ω–∏–∫–∏ 2026',
        '–≤—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏': '–ø—Ä–∞–∑–¥–Ω–∏–∫–∏ 2026',
        '–ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–µ –¥–Ω–∏': '–ø—Ä–∞–∑–¥–Ω–∏–∫–∏ 2026',
        '–º–µ—á–µ–ª –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ': '–ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ',
        '–ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ': '–º–µ—á–µ–ª –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ',
        '–ª—É—á—à–∏–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫': '–º–µ—á–µ–ª –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ',
        '–Ω–∞—Å—Ç–∞–≤–Ω–∏–∫ –≥–æ–¥–∞': '–º–µ—á–µ–ª –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ',
        '–∏–Ω–Ω–æ–≤–∞—Ç–æ—Ä': '—Ä–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—Å–∫–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ',
        '–≤–æ–ª–æ–Ω—Ç–µ—Ä—Å—Ç–≤–æ': '–≤–æ–ª–æ–Ω—Ç–µ—Ä—Å—Ç–≤–æ',
        '–º–µ—á–µ–ª –∑–∞ –¥–æ–±—Ä–æ': '–≤–æ–ª–æ–Ω—Ç–µ—Ä—Å—Ç–≤–æ',
        '–±–ª–∞–≥–æ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å': '–≤–æ–ª–æ–Ω—Ç–µ—Ä—Å—Ç–≤–æ',
        '–ø–æ–º–æ—â—å –≤–µ—Ç–µ—Ä–∞–Ω–∞–º': '–≤–æ–ª–æ–Ω—Ç–µ—Ä—Å—Ç–≤–æ',
        '—Ç–µ–ª–µ–≥—Ä–∞–º –∫–∞–Ω–∞–ª': '–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –∫–∞–Ω–∞–ª',
        '—Ç–≥ –∫–∞–Ω–∞–ª': '–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –∫–∞–Ω–∞–ª',
        '@mechelofficial': '–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –∫–∞–Ω–∞–ª',
        '–Ω–æ–≤–æ—Å—Ç–∏ –∫–æ–º–ø–∞–Ω–∏–∏': '–ø–æ—Ä—Ç–∞–ª —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤',
        '–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏': '–ø–æ—Ä—Ç–∞–ª —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤',
        '–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –∂—É—Ä–Ω–∞–ª': '–º–µ—á–µ–ª —Å–µ–≥–æ–¥–Ω—è',
        '–∂—É—Ä–Ω–∞–ª –º–µ—á–µ–ª': '–º–µ—á–µ–ª —Å–µ–≥–æ–¥–Ω—è',
        '–¥–æ—Å–∫–∞ –ø–æ—á–µ—Ç–∞': '–≥–æ—Ä–¥–æ—Å—Ç—å –º–µ—á–µ–ª–∞',
        '–≥–æ—Ä–¥–æ—Å—Ç—å –º–µ—á–µ–ª–∞': '–¥–æ—Å–∫–∞ –ø–æ—á–µ—Ç–∞',

        # ---------- –°–û–¶–ü–ê–ö–ï–¢ ----------
        '–¥–æ–±—Ä–æ–≤–æ–ª—å–Ω–æ–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–µ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ': '–¥–º—Å',
        '–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞': '–¥–º—Å',
        '–ø–æ–ª–∏—Å –¥–º—Å': '–¥–º—Å',
        '—Å—Ç—Ä–∞—Ö–æ–≤–∫–∞': '–¥–º—Å',
        '–ª—å–≥–æ—Ç—ã –º–Ω–æ–≥–æ–¥–µ—Ç–Ω—ã–º': '–ª—å–≥–æ—Ç—ã –º–Ω–æ–≥–æ–¥–µ—Ç–Ω—ã–º',
        '–º–Ω–æ–≥–æ–¥–µ—Ç–Ω—ã–µ —Å–µ–º—å–∏': '–ª—å–≥–æ—Ç—ã –º–Ω–æ–≥–æ–¥–µ—Ç–Ω—ã–º',
        '–º–Ω–æ–≥–æ–¥–µ—Ç–Ω—ã–µ': '–ª—å–≥–æ—Ç—ã –º–Ω–æ–≥–æ–¥–µ—Ç–Ω—ã–º',
        '—à–∫–æ–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞': '–ª—å–≥–æ—Ç—ã –º–Ω–æ–≥–æ–¥–µ—Ç–Ω—ã–º',
        '–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è —Å–∞–¥–∞': '–¥–µ—Ç—Å–∫–∏–π —Å–∞–¥',
        '–¥–µ—Ç—Å–∫–∏–π —Å–∞–¥': '–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è',
        '—Å–∞–Ω–∞—Ç–æ—Ä–Ω–æ –∫—É—Ä–æ—Ä—Ç–Ω–∞—è –ø—É—Ç–µ–≤–∫–∞': '—Å–∞–Ω–∞—Ç–æ—Ä–Ω–æ-–∫—É—Ä–æ—Ä—Ç–Ω–∞—è –ø—É—Ç–µ–≤–∫–∞',
        '–ø—É—Ç–µ–≤–∫–∞': '—Å–∞–Ω–∞—Ç–æ—Ä–Ω–æ-–∫—É—Ä–æ—Ä—Ç–Ω–∞—è –ø—É—Ç–µ–≤–∫–∞',
        '—Å–∞–Ω–∞—Ç–æ—Ä–∏–π': '—Å–∞–Ω–∞—Ç–æ—Ä–Ω–æ-–∫—É—Ä–æ—Ä—Ç–Ω–∞—è –ø—É—Ç–µ–≤–∫–∞',
        '–æ—Ç–¥—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤': '—Å–∞–Ω–∞—Ç–æ—Ä–Ω–æ-–∫—É—Ä–æ—Ä—Ç–Ω–∞—è –ø—É—Ç–µ–≤–∫–∞',
        '–º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω–∞—è –ø–æ–º–æ—â—å': '–º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω–∞—è –ø–æ–º–æ—â—å',
        '–º–∞—Ç–ø–æ–º–æ—â—å': '–º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω–∞—è –ø–æ–º–æ—â—å',
        '—Ñ–∏–Ω–∞–Ω—Å–æ–≤–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞': '–º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω–∞—è –ø–æ–º–æ—â—å',
        '—Å–æ—Ü–∏–∞–ª—å–Ω–∞—è –ø–æ–º–æ—â—å': '–º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω–∞—è –ø–æ–º–æ—â—å',
        '–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –ø—Ä–æ–µ–∑–¥–∞': '–ø—Ä–æ–µ–∑–¥ –∫ –º–µ—Å—Ç—É –æ—Ç–¥—ã—Ö–∞',
        '–ø—Ä–æ–µ–∑–¥ –∫ –º–µ—Å—Ç—É –æ—Ç–¥—ã—Ö–∞': '–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –ø—Ä–æ–µ–∑–¥–∞',
        '–±–∏–ª–µ—Ç—ã': '–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –ø—Ä–æ–µ–∑–¥–∞',
        '–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –∑–∞ –æ–±—É—á–µ–Ω–∏–µ –¥–µ—Ç–µ–π': '–æ–±—É—á–µ–Ω–∏–µ –¥–µ—Ç–µ–π',
        '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–µ—Ç–µ–π': '–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –∑–∞ –æ–±—É—á–µ–Ω–∏–µ –¥–µ—Ç–µ–π',
        '–≤–µ—Ç–µ—Ä–∞–Ω—ã —Ç—Ä—É–¥–∞': '–ª—å–≥–æ—Ç—ã –≤–µ—Ç–µ—Ä–∞–Ω–∞–º',
        '–ø–æ—á–µ—Ç–Ω—ã–µ –≤–µ—Ç–µ—Ä–∞–Ω—ã': '–≤–µ—Ç–µ—Ä–∞–Ω—ã —Ç—Ä—É–¥–∞',
        '–ø—Ä–æ—Ñ—Å–æ—é–∑': '–ø—Ä–æ—Ñ—Å–æ—é–∑–Ω—ã–µ –ª—å–≥–æ—Ç—ã',
        '–ø—Ä–æ—Ñ—Å–æ—é–∑–Ω—ã–µ –≤–∑–Ω–æ—Å—ã': '–ø—Ä–æ—Ñ—Å–æ—é–∑',
        '—á–ª–µ–Ω—Å—Ç–≤–æ –≤ –ø—Ä–æ—Ñ—Å–æ—é–∑–µ': '–ø—Ä–æ—Ñ—Å–æ—é–∑',

        # ---------- –†–ê–ó–í–ò–¢–ò–ï ----------
        '–ø—Ä–æ–≥—Ä–∞–º–º—ã –æ–±—É—á–µ–Ω–∏—è': '–æ–±—É—á–µ–Ω–∏–µ',
        '–ø–æ–≤—ã—à–µ–Ω–∏–µ –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–∏': '–æ–±—É—á–µ–Ω–∏–µ',
        '–∫—É—Ä—Å—ã –ø–æ–≤—ã—à–µ–Ω–∏—è –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–∏': '–æ–±—É—á–µ–Ω–∏–µ',
        '—Ç—Ä–µ–Ω–∏–Ω–≥': '–æ–±—É—á–µ–Ω–∏–µ',
        '–∫—É—Ä—Å—ã': '–æ–±—É—á–µ–Ω–∏–µ',
        '–¥–æ—Å—Ç–æ—è–Ω–∏–µ –º–µ—á–µ–ª–∞': '–ø—Ä–æ–≥—Ä–∞–º–º–∞ –¥–æ—Å—Ç–æ—è–Ω–∏–µ',
        '–ª–∏–¥–µ—Ä –º–µ—á–µ–ª–∞': '–ø—Ä–æ–≥—Ä–∞–º–º–∞ –ª–∏–¥–µ—Ä',
        '—Ä–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—Å–∫–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ': '–∏–Ω–Ω–æ–≤–∞—Ç–æ—Ä –º–µ—á–µ–ª–∞',
        '–ø–æ–¥–∞—á–∞ –∏–¥–µ–∏': '—Ä–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—Å–∫–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ',
        '–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞': '–±–∏–±–ª–∏–æ—Ç–µ–∫–∞',
        '—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞': '–±–∏–±–ª–∏–æ—Ç–µ–∫–∞',
        '–∫–Ω–∏–≥–∏': '–±–∏–±–ª–∏–æ—Ç–µ–∫–∞',
        '–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Ä—Ç': '—Å–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ —Å–µ–∫—Ü–∏–∏',
        '—Å–ø–æ—Ä—Ç': '–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Ä—Ç',
        '—Ñ–∏—Ç–Ω–µ—Å': '—Å–ø–æ—Ä—Ç',
        '—Ñ—É—Ç–±–æ–ª': '–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Ä—Ç',
        '–≤–æ–ª–µ–π–±–æ–ª': '–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Ä—Ç',

        # ---------- –û–§–ò–° –ò –ò–ù–§–†–ê–°–¢–†–£–ö–¢–£–†–ê ----------
        '—Å–∏—Å—Ç–µ–º–∞ –ø–∏—Ç–∞–Ω–∏—è': '–ø–∏—Ç–∞–Ω–∏–µ',
        '–∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ –ø–∏—Ç–∞–Ω–∏–µ': '–ø–∏—Ç–∞–Ω–∏–µ',
        '—Å—Ç–æ–ª–æ–≤–∞—è': '–ø–∏—Ç–∞–Ω–∏–µ',
        '–æ–±–µ–¥': '–ø–∏—Ç–∞–Ω–∏–µ',
        '–µ–¥–∞': '–ø–∏—Ç–∞–Ω–∏–µ',
        '–ø–æ–µ—Å—Ç—å': '–ø–∏—Ç–∞–Ω–∏–µ',
        '–∫–æ—Ñ–µ–º–∞—à–∏–Ω–∞': '–≤–µ–Ω–¥–∏–Ω–≥',
        '–≤–µ–Ω–¥–∏–Ω–≥–æ–≤—ã–µ –∞–ø–ø–∞—Ä–∞—Ç—ã': '–≤–µ–Ω–¥–∏–Ω–≥',
        '—Å–Ω–µ–∫–æ–≤—ã–π –∞–≤—Ç–æ–º–∞—Ç': '–≤–µ–Ω–¥–∏–Ω–≥',
        '–∫–æ—Ñ–µ': '–≤–µ–Ω–¥–∏–Ω–≥',
        '—á–∞–π': '–≤–µ–Ω–¥–∏–Ω–≥',
        '–ø–∏—Ç—å–µ–≤–∞—è –≤–æ–¥–∞': '–≤–æ–¥–∞',
        '–∫—É–ª–µ—Ä': '–≤–æ–¥–∞',
        '–∑–∞–∫–∞–∑ –≤–æ–¥—ã': '–≤–æ–¥–∞',
        '–ø–µ—Ä–µ–≥–æ–≤–æ—Ä–Ω–∞—è –∫–æ–º–Ω–∞—Ç–∞': '–ø–µ—Ä–µ–≥–æ–≤–æ—Ä–Ω–∞—è',
        '–∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü –∑–∞–ª': '–ø–µ—Ä–µ–≥–æ–≤–æ—Ä–Ω–∞—è',
        '–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–Ω–æ–π': '–ø–µ—Ä–µ–≥–æ–≤–æ—Ä–Ω–∞—è',
        '–º–∏—Ç–∏–Ω–≥': '–≤—Å—Ç—Ä–µ—á–∞',
        '—Å–æ–≤–µ—â–∞–Ω–∏–µ': '–ø–µ—Ä–µ–≥–æ–≤–æ—Ä–Ω–∞—è',
        '–≤—Å—Ç—Ä–µ—á–∞': '–ø–µ—Ä–µ–≥–æ–≤–æ—Ä–Ω–∞—è',
        '–ø–∞—Ä–∫–æ–≤–æ—á–Ω—ã–µ –º–µ—Å—Ç–∞': '–ø–∞—Ä–∫–æ–≤–∫–∞',
        '—Å—Ç–æ—è–Ω–∫–∞': '–ø–∞—Ä–∫–æ–≤–∫–∞',
        '–∞–≤—Ç–æ': '–ø–∞—Ä–∫–æ–≤–∫–∞',
        '–¥–µ–ª–æ–≤–æ–π —Å—Ç–∏–ª—å': '–¥—Ä–µ—Å—Å-–∫–æ–¥',
        '–≤–Ω–µ—à–Ω–∏–π –≤–∏–¥': '–¥—Ä–µ—Å—Å-–∫–æ–¥',
        '–æ–¥–µ–∂–¥–∞ –≤ –æ—Ñ–∏—Å–µ': '–¥—Ä–µ—Å—Å-–∫–æ–¥',
        '–∑–æ–Ω–∞ –¥–ª—è –∫—É—Ä–µ–Ω–∏—è': '–∫—É—Ä–∏–ª–∫–∞',
        '–º–µ—Å—Ç–æ –¥–ª—è –∫—É—Ä–µ–Ω–∏—è': '–∫—É—Ä–∏–ª–∫–∞',
        '–∫—É—Ä–µ–Ω–∏–µ': '–∫—É—Ä–∏–ª–∫–∞',
        '–≤–µ—Ä—Ö–Ω—è—è –æ–¥–µ–∂–¥–∞': '–≥–∞—Ä–¥–µ—Ä–æ–±',
        '—Ä–∞–∑–¥–µ–≤–∞–ª–∫–∞': '–≥–∞—Ä–¥–µ—Ä–æ–±',
        '–≤–µ—à–∞–ª–∫–∞': '–≥–∞—Ä–¥–µ—Ä–æ–±',
        '–º—Ñ—É': '–ø—Ä–∏–Ω—Ç–µ—Ä',
        '—Å–∫–∞–Ω–µ—Ä': '–ø—Ä–∏–Ω—Ç–µ—Ä',
        '–ø–µ—á–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤': '–ø—Ä–∏–Ω—Ç–µ—Ä',
        '–∑–æ–Ω—Ç –Ω–∞–ø—Ä–æ–∫–∞—Ç': '–∑–æ–Ω—Ç',
        '–¥–æ–∂–¥—å': '–∑–æ–Ω—Ç',
        '–∫–∞–Ω—Ü–µ–ª—è—Ä—Å–∫–∏–µ —Ç–æ–≤–∞—Ä—ã': '–∫–∞–Ω—Ü–µ–ª—è—Ä–∏—è',
        '–∫–∞–Ω—Ü—Ç–æ–≤–∞—Ä—ã': '–∫–∞–Ω—Ü–µ–ª—è—Ä–∏—è',
        '–æ—Ñ–∏—Å–Ω—ã–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏': '–∫–∞–Ω—Ü–µ–ª—è—Ä–∏—è',
        '–≤—Ç–æ—Ä—Å—ã—Ä—å–µ': '–ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞',
        '—Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –º—É—Å–æ—Ä–∞': '–≤—Ç–æ—Ä—Å—ã—Ä—å–µ',
        '–±–∞—Ç–∞—Ä–µ–π–∫–∏': '–≤—Ç–æ—Ä—Å—ã—Ä—å–µ',
        '–ø–ª–∞—Å—Ç–∏–∫': '–≤—Ç–æ—Ä—Å—ã—Ä—å–µ',

        # ---------- IT ----------
        '–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–æ—á—Ç–∞': '–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–æ—á—Ç–∞',
        '@mechel.com': '–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–æ—á—Ç–∞',
        'email': '–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–æ—á—Ç–∞',
        'outlook': '–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–æ—á—Ç–∞',
        'lotus notes': '–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–æ—á—Ç–∞',
        'lotus': 'lotus notes',
        '–∞–≤—Ç–æ–æ—Ç–≤–µ—Ç': 'out of office',
        '–ø–æ–¥–ø–∏—Å—å': '–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥–ø–∏—Å–∏',
        'it –ø–æ–¥–¥–µ—Ä–∂–∫–∞': 'it-–ø–æ–¥–¥–µ—Ä–∂–∫–∞',
        '—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞': 'it-–ø–æ–¥–¥–µ—Ä–∂–∫–∞',
        '—Ö–µ–ª–ø–¥–µ—Å–∫': 'it-–ø–æ–¥–¥–µ—Ä–∂–∫–∞',
        'helpdesk': 'it-–ø–æ–¥–¥–µ—Ä–∂–∫–∞',
        '–ø–æ–ª–æ–º–∫–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞': 'it-–ø–æ–¥–¥–µ—Ä–∂–∫–∞',
        '1—Å –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ': '1—Å',
        '1—Å': '1—Å',
        'vpn': 'vpn',
        '–≤–ø–Ω': 'vpn',
        '—É–¥–∞–ª–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø': 'vpn',
        '—É–¥–∞–ª–µ–Ω–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ': 'vpn',
        '—Ä–∞–±–æ—á–∏–π –∫–æ–º–ø—å—é—Ç–µ—Ä': '—É–¥–∞–ª–µ–Ω–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ',
        'rdp': '—É–¥–∞–ª–µ–Ω–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ',
        'wi fi': 'wi-fi',
        '–≤–∞–π—Ñ–∞–π': 'wi-fi',
        '–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç': 'wi-fi',
        '–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω': '–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω',
        '–º–æ–±–∏–ª—å–Ω–∞—è —Å–≤—è–∑—å': '–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω',
        '—Å–∏–º –∫–∞—Ä—Ç–∞': '–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω',
        'avaya': '–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è —Ç–µ–ª–µ—Ñ–æ–Ω–∏—è',
        '–ø–æ—Ä—Ç–∞–ª —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤': '–ø–æ—Ä—Ç–∞–ª',
        '–ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç': '–ø–æ—Ä—Ç–∞–ª',
        '–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–æ–ª—å': '–∑–∞–±—ã–ª –ø–∞—Ä–æ–ª—å',
        '–∑–∞–±—ã–ª –ø–∞—Ä–æ–ª—å': '–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–æ–ª—å',
        '–¥–æ—Å—Ç—É–ø –∫ 1—Å': '1—Å',
        '—ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –±–∞–∑–∞': '–¥–æ—Å—Ç—É–ø –∫ –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö',
        '–±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö': '—ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã',

        # ---------- –ì–†–ê–§–ò–ö –†–ê–ë–û–¢–´ ----------
        '–≥–∏–±–∫–∏–π –≥—Ä–∞—Ñ–∏–∫': '—Å–∫–æ–ª—å–∑—è—â–∏–π –≥—Ä–∞—Ñ–∏–∫',
        '—Å–∫–æ–ª—å–∑—è—â–∏–π –≥—Ä–∞—Ñ–∏–∫': '–≥–∏–±–∫–∏–π –≥—Ä–∞—Ñ–∏–∫',
        '—É–¥–∞–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞': '—É–¥–∞–ª–µ–Ω–∫–∞',
        '–¥–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞': '—É–¥–∞–ª–µ–Ω–∫–∞',
        '—Ä–∞–±–æ—Ç–∞ –∏–∑ –¥–æ–º–∞': '—É–¥–∞–ª–µ–Ω–∫–∞',
        '–≥–∏–±—Ä–∏–¥–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫': '–≥–∏–±—Ä–∏–¥',
        '–≥–∏–±—Ä–∏–¥': '–≥–∏–±—Ä–∏–¥–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫',
        '—É—á–µ—Ç —Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏': '—Ç–∞–±–µ–ª—å',
        '–æ–ø–æ–∑–¥–∞–Ω–∏–µ': '–¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞',
        '–¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞': '–æ–ø–æ–∑–¥–∞–Ω–∏–µ',
        '–≤–∑—ã—Å–∫–∞–Ω–∏–µ': '–æ–ø–æ–∑–¥–∞–Ω–∏–µ',

        # ---------- –î–û–ö–£–ú–ï–ù–¢–´ ----------
        '—Å–ø—Ä–∞–≤–∫–∞ 2 –Ω–¥—Ñ–ª': '2-–Ω–¥—Ñ–ª',
        '2–Ω–¥—Ñ–ª': '2-–Ω–¥—Ñ–ª',
        '–Ω–∞–ª–æ–≥–æ–≤–∞—è —Å–ø—Ä–∞–≤–∫–∞': '2-–Ω–¥—Ñ–ª',
        '—Å–ø—Ä–∞–≤–∫–∞ –æ –¥–æ—Ö–æ–¥–∞—Ö': '2-–Ω–¥—Ñ–ª',
        '—Ä–∞—Å—á–µ—Ç–Ω—ã–π –ª–∏—Å—Ç': '—Ä–∞—Å—á–µ—Ç–Ω–∞—è –≤–µ–¥–æ–º–æ—Å—Ç—å',
        '—Ä–∞—Å—á–µ—Ç–Ω–∞—è –≤–µ–¥–æ–º–æ—Å—Ç—å': '–ø–æ—Ä—Ç–∞–ª',
        '—ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è —Ç—Ä—É–¥–æ–≤–∞—è –∫–Ω–∏–∂–∫–∞': '—ç—Ç–∫',
        '—ç—Ç–∫': '—ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è —Ç—Ä—É–¥–æ–≤–∞—è –∫–Ω–∏–∂–∫–∞',
        '–∑–∞–∫–∞–∑ –≤–∏–∑–∏—Ç–æ–∫': '–≤–∏–∑–∏—Ç–∫–∏',
        '–≤–∏–∑–∏—Ç–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞': '–≤–∏–∑–∏—Ç–∫–∏',

        # ---------- –§–ò–ù–ê–ù–°–´ ----------
        '–Ω–∞–ª–æ–≥–æ–≤—ã–π –≤—ã—á–µ—Ç': '–≤—ã—á–µ—Ç',
        '—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã—á–µ—Ç': '–Ω–∞–ª–æ–≥–æ–≤—ã–π –≤—ã—á–µ—Ç',
        '–≤—ã—á–µ—Ç –Ω–∞ –¥–µ—Ç–µ–π': '–Ω–∞–ª–æ–≥–æ–≤—ã–π –≤—ã—á–µ—Ç',
        '–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –∑–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—å': '–ª–∏—á–Ω—ã–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç',
        '–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –∑–∞ –∞–≤—Ç–æ': '–ª–∏—á–Ω—ã–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç',
        '—Å–ª—É–∂–µ–±–Ω–∞—è –ø–æ–µ–∑–¥–∫–∞': '–∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∞',
        '–∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–æ—á–Ω—ã–µ': '–∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∞',

        # ---------- –¢–†–ê–ù–°–ü–û–†–¢ ----------
        '–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–µ —Ç–∞–∫—Å–∏': '—Ç–∞–∫—Å–∏',
        '—è–Ω–¥–µ–∫—Å —Ç–∞–∫—Å–∏ –±–∏–∑–Ω–µ—Å': '—Ç–∞–∫—Å–∏',
        '—Å–ª—É–∂–µ–±–Ω—ã–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç': '–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç',
        '—Ä–∞–∑—ä–µ–∑–¥–Ω–æ–π –∞–≤—Ç–æ–±—É—Å': '–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç',
        '–∑–∞—è–≤–∫–∞ –Ω–∞ –∞–≤—Ç–æ': '–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç',

        # ---------- –ú–ï–î–ò–¶–ò–ù–ê ----------
        '–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π –∫–∞–±–∏–Ω–µ—Ç': '–∑–¥—Ä–∞–≤–ø—É–Ω–∫—Ç',
        '–∑–¥—Ä–∞–≤–ø—É–Ω–∫—Ç': '–º–µ–¥–ø—É–Ω–∫—Ç',
        '—Ñ–µ–ª—å–¥—à–µ—Ä': '–º–µ–¥–ø—É–Ω–∫—Ç',
        '—Å–ø—Ä–∞–≤–∫–∞ –æ –±–æ–ª–µ–∑–Ω–∏': '–≤—Ä–∞—á',
        '–¥–∞–≤–ª–µ–Ω–∏–µ': '–º–µ–¥–ø—É–Ω–∫—Ç',
        '—Ç–µ—Ä–∞–ø–µ–≤—Ç': '–≤—Ä–∞—á',

        # ---------- –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ ----------
        '—Å–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞': '–ø—Ä–æ–ø—É—Å–∫',
        '–∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π –ø—É–Ω–∫—Ç': '–∫–ø–ø',
        '—Å–∫—É –¥': '–ø—Ä–æ–ø—É—Å–∫',
        '—Å–∫—É–¥': '–ø—Ä–æ–ø—É—Å–∫',
        '–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø—Ä–æ–ø—É—Å–∫': '–ø—Ä–æ–ø—É—Å–∫ –¥–ª—è –≥–æ—Å—Ç–µ–π',
        '–≥–æ—Å—Ç–µ–≤–æ–π –ø—Ä–æ–ø—É—Å–∫': '–ø—Ä–æ–ø—É—Å–∫ –¥–ª—è –≥–æ—Å—Ç–µ–π',
        '–ø–æ—Å–µ—Ç–∏—Ç–µ–ª—å': '–ø—Ä–æ–ø—É—Å–∫ –¥–ª—è –≥–æ—Å—Ç–µ–π',
        '–¥—É–±–ª–∏–∫–∞—Ç –ø—Ä–æ–ø—É—Å–∫–∞': '–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–∞',
        '—É—Ç–µ—Ä—è –ø—Ä–æ–ø—É—Å–∫–∞': '–¥—É–±–ª–∏–∫–∞—Ç –ø—Ä–æ–ø—É—Å–∫–∞',
        '–∞–ø—Ç–µ—á–∫–∞': '–ø–µ—Ä–≤–∞—è –ø–æ–º–æ—â—å',
        '–ø–µ—Ä–≤–∞—è –ø–æ–º–æ—â—å': '–∞–ø—Ç–µ—á–∫–∞',
        '–ø—Ä–æ–Ω–æ—Å –≤–µ—â–µ–π': '–∫–ø–ø',

        # ---------- –ö–û–ù–¢–ê–ö–¢–´ ----------
        '–ø–æ–º–æ—â–Ω–∏–∫–∏ —Ç–æ–ø –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞': '–ø–æ–º–æ—â–Ω–∏–∫ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è',
        '—Å–µ–∫—Ä–µ—Ç–∞—Ä—å –≥–µ–Ω–¥–∏—Ä–µ–∫—Ç–æ—Ä–∞': '–ø–æ–º–æ—â–Ω–∏–∫–∏',
        '—Å–µ—Ä–≤–∏—Å–Ω—ã–µ —Å–ª—É–∂–±—ã': '–∫–æ–Ω—Ç–∞–∫—Ç—ã',
        '–∏–Ω–∂–µ–Ω–µ—Ä–Ω–∞—è —Å–ª—É–∂–±–∞': '—Å–µ—Ä–≤–∏—Å–Ω—ã–µ —Å–ª—É–∂–±—ã',
    }

    # –°—Ç–æ–ø-—Å–ª–æ–≤–∞ –æ—Å—Ç–∞–≤–ª–µ–Ω—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
    STOP_WORDS = {
        '–∫–∞–∫', '—á—Ç–æ', '–≥–¥–µ', '–∫–æ–≥–¥–∞', '–ø–æ—á–µ–º—É', '–∑–∞—á–µ–º', '—Å–∫–æ–ª—å–∫–æ', '—á–µ–π',
        '–∞', '–∏', '–Ω–æ', '–∏–ª–∏', '–µ—Å–ª–∏', '—Ç–æ', '–∂–µ', '–±—ã', '–≤', '–Ω–∞', '—Å', '–ø–æ',
        '–æ', '–æ–±', '–æ—Ç', '–¥–æ', '–¥–ª—è', '–∏–∑', '—É', '–Ω–µ', '–Ω–µ—Ç', '–¥–∞', '—ç—Ç–æ',
        '—Ç–æ—Ç', '—ç—Ç–æ—Ç', '—Ç–∞–∫–æ–π', '–∫–∞–∫–æ–π', '–≤—Å–µ', '–≤—Å—ë', '–µ–≥–æ', '–µ–µ', '–∏—Ö',
        '–º–æ–∂–Ω–æ', '–Ω—É–∂–Ω–æ', '–Ω–∞–¥–æ', '–±—É–¥–µ—Ç', '–µ—Å—Ç—å', '–±—ã—Ç—å', '–≤–µ—Å—å', '—ç—Ç–∞', '—ç—Ç–∏'
    }

    def __init__(self, max_cache_size: int = 200):
        self.max_cache_size = max_cache_size
        self.cache = OrderedDict()
        self.cache_ttl = {}
        self.faq_data: List[FAQEntry] = []
        self._category_index: Dict[str, List[FAQEntry]] = defaultdict(list)
        self._inverted_index: Dict[str, Set[FAQEntry]] = defaultdict(set)
        self._doc_count: int = 0
        self._idf_cache: Dict[str, float] = {}

        self.stats = {
            'total_searches': 0,
            'cache_hits': 0,
            'cache_misses': 0,
            'loaded_from': '–Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ'
        }

        self._load_faq()
        self._build_indexes()
        logger.info(f"‚úÖ SearchEngine v5.0: –∑–∞–≥—Ä—É–∂–µ–Ω–æ {len(self.faq_data)} –∑–∞–ø–∏—Å–µ–π, "
                    f"–∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω–¥–µ–∫—Å: {len(self._inverted_index)} —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤, "
                    f"–∏—Å—Ç–æ—á–Ω–∏–∫: {self.stats['loaded_from']}")

    # ------------------------------------------------------------
    #  –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–•
    # ------------------------------------------------------------
    def _load_faq(self):
        if self._load_from_json():
            return
        logger.warning("‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å faq.json, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã")
        self._load_fallback()

    def _load_from_json(self) -> bool:
        json_path = "faq.json"
        if not os.path.exists(json_path):
            logger.debug(f"–§–∞–π–ª {json_path} –Ω–µ –Ω–∞–π–¥–µ–Ω")
            return False

        try:
            with open(json_path, 'r', encoding='utf-8') as f:
                data = json.load(f)

            self.faq_data.clear()
            loaded_count = 0
            for idx, item in enumerate(data, start=1):
                question = item.get('question', '').strip()
                answer = item.get('answer', '').strip()
                if not question or not answer:
                    continue

                keywords_raw = item.get('keywords', '')
                if isinstance(keywords_raw, list):
                    keywords_str = ', '.join(keywords_raw)
                else:
                    keywords_str = keywords_raw

                norm_keywords = item.get('norm_keywords', '')
                if not norm_keywords and keywords_str:
                    norm_keywords = self._normalize_text(keywords_str)

                norm_question = item.get('norm_question', '')
                if not norm_question and question:
                    norm_question = self._normalize_text(question)

                faq = FAQEntry(
                    id=idx,
                    question=question,
                    answer=answer,
                    keywords=keywords_str,
                    norm_keywords=norm_keywords,
                    norm_question=norm_question,
                    category=item.get('category', '–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏').strip()
                )
                self.faq_data.append(faq)
                loaded_count += 1

            self.stats['loaded_from'] = f'JSON ({loaded_count} –∑–∞–ø–∏—Å–µ–π)'
            logger.info(f"‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ {loaded_count} –∑–∞–ø–∏—Å–µ–π –∏–∑ {json_path}")
            return True
        except Exception as e:
            logger.error(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ JSON: {e}")
            return False

    def _load_fallback(self):
        self.faq_data = [
            FAQEntry(
                id=1,
                question="–ö–∞–∫ –æ—Ñ–æ—Ä–º–∏—Ç—å –æ—Ç–ø—É—Å–∫?",
                answer="–û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –æ—Ç–¥–µ–ª –∫–∞–¥—Ä–æ–≤ —Å –∑–∞—è–≤–ª–µ–Ω–∏–µ–º –∑–∞ 2 –Ω–µ–¥–µ–ª–∏ –¥–æ –Ω–∞—á–∞–ª–∞ –æ—Ç–ø—É—Å–∫–∞.",
                keywords="–æ—Ç–ø—É—Å–∫, –æ—Ñ–æ—Ä–º–∏—Ç—å, –∫–∞–¥—Ä—ã, –∑–∞—è–≤–ª–µ–Ω–∏–µ",
                norm_keywords="–æ—Ç–ø—É—Å–∫ –æ—Ñ–æ—Ä–º–∏—Ç—å –∫–∞–¥—Ä—ã –∑–∞—è–≤–ª–µ–Ω–∏–µ",
                norm_question="–∫–∞–∫ –æ—Ñ–æ—Ä–º–∏—Ç—å –æ—Ç–ø—É—Å–∫",
                category="–û—Ç–ø—É—Å–∫"
            ),
            FAQEntry(
                id=2,
                question="–ö–æ–≥–¥–∞ –≤—ã–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –∑–∞—Ä–ø–ª–∞—Ç–∞?",
                answer="–ó–∞—Ä–ø–ª–∞—Ç–∞ –≤—ã–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è 5 –∏ 20 —á–∏—Å–ª–∞ –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—è—Ü–∞.",
                keywords="–∑–∞—Ä–ø–ª–∞—Ç–∞, –≤—ã–ø–ª–∞—Ç–∞, –¥–∞—Ç–∞, –∞–≤–∞–Ω—Å",
                norm_keywords="–∑–∞—Ä–ø–ª–∞—Ç–∞ –≤—ã–ø–ª–∞—Ç–∞ –¥–∞—Ç–∞ –∞–≤–∞–Ω—Å",
                norm_question="–∫–æ–≥–¥–∞ –≤—ã–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –∑–∞—Ä–ø–ª–∞—Ç–∞",
                category="–ó–∞—Ä–ø–ª–∞—Ç–∞"
            )
        ]
        self.stats['loaded_from'] = '—Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (2 –∑–∞–ø–∏—Å–∏)'

    # ------------------------------------------------------------
    #  –ü–û–°–¢–†–û–ï–ù–ò–ï –ò–ù–î–ï–ö–°–û–í
    # ------------------------------------------------------------
    def _build_indexes(self):
        """–°—Ç—Ä–æ–∏—Ç –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω–¥–µ–∫—Å, –∫–∞—Ç–µ–≥–æ—Ä–∏–π–Ω—ã–π –∏–Ω–¥–µ–∫—Å –∏ IDF –∫—ç—à."""
        self._category_index.clear()
        self._inverted_index.clear()
        self._doc_count = len(self.faq_data)

        for faq in self.faq_data:
            # –ö–∞—Ç–µ–≥–æ—Ä–∏–π–Ω—ã–π –∏–Ω–¥–µ–∫—Å (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π)
            cat_lower = faq.category.lower().strip()
            self._category_index[cat_lower].append(faq)

            # –ò–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω–¥–µ–∫—Å
            words = set()
            if faq.norm_question:
                words.update(faq.norm_question.split())
            if faq.norm_keywords:
                words.update(faq.norm_keywords.split())
            for word in words:
                self._inverted_index[word].add(faq)

        # –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞—Å—á—ë—Ç IDF
        self._idf_cache.clear()
        for word, doc_set in self._inverted_index.items():
            df = len(doc_set)
            self._idf_cache[word] = math.log((self._doc_count + 1) / (df + 1)) + 1  # +1 –¥–ª—è —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è

        logger.debug(f"–ò–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω–¥–µ–∫—Å —Å–æ–¥–µ—Ä–∂–∏—Ç {len(self._inverted_index)} —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤")

    # ------------------------------------------------------------
    #  –ù–û–†–ú–ê–õ–ò–ó–ê–¶–ò–Ø –¢–ï–ö–°–¢–ê
    # ------------------------------------------------------------
    def _normalize_text(self, text: str) -> str:
        if not text:
            return ""

        text = text.lower().strip()
        # –ó–∞–º–µ–Ω–∞ —ë –Ω–∞ –µ
        text = text.replace('—ë', '–µ')

        # –ó–∞–º–µ–Ω–∞ —Å–∏–Ω–æ–Ω–∏–º–æ–≤ (—Å–Ω–∞—á–∞–ª–∞ –¥–ª–∏–Ω–Ω—ã–µ —Ñ—Ä–∞–∑—ã)
        for phrase, repl in sorted(self.SYNONYMS.items(), key=lambda x: -len(x[0])):
            pattern = r'(?<!\w)' + re.escape(phrase) + r'(?!\w)'
            text = re.sub(pattern, repl, text)

        # –£–¥–∞–ª—è–µ–º –≤—Å–µ –Ω–µ-–±—É–∫–≤–µ–Ω–Ω–æ-—Ü–∏—Ñ—Ä–æ–≤—ã–µ —Å–∏–º–≤–æ–ª—ã, –∫—Ä–æ–º–µ –ø—Ä–æ–±–µ–ª–æ–≤
        text = re.sub(r'[^\w\s]', ' ', text)
        words = text.split()

        # –£–¥–∞–ª—è–µ–º —Å—Ç–æ–ø-—Å–ª–æ–≤–∞ –∏ –∫–æ—Ä–æ—Ç–∫–∏–µ —Å–ª–æ–≤–∞ (<=2 —Å–∏–º–≤–æ–ª–æ–≤)
        words = [w for w in words if w not in self.STOP_WORDS and len(w) > 2]

        # –ü—Ä–æ—Å—Ç–µ–π—à–∏–π —Å—Ç–µ–º–º–∏–Ω–≥ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Å–ª–æ–≤ –¥–ª–∏–Ω–Ω–µ–µ 3 —Å–∏–º–≤–æ–ª–æ–≤)
        normalized = []
        for w in words:
            if len(w) > 3:
                if w.endswith('—Ç—å—Å—è'):
                    w = w[:-4] + '—Ç—å'
                elif w.endswith('—Ç—Å—è'):
                    w = w[:-3] + '—Ç—å—Å—è'
                elif w.endswith('–∞—Ç—å') and len(w) > 4:
                    w = w[:-3]
                elif w.endswith('—è—Ç—å') and len(w) > 4:
                    w = w[:-3]
                elif w.endswith('–∏—Ç—å') and len(w) > 4:
                    w = w[:-3]
                elif w.endswith('–µ—Ç—å') and len(w) > 4:
                    w = w[:-3]
                elif w.endswith('—ã–π') or w.endswith('–∏–π') or w.endswith('–æ–π'):
                    w = w[:-2]
                elif w.endswith('–∞—è') or w.endswith('—è—è'):
                    w = w[:-2]
                elif w.endswith('–æ–µ') or w.endswith('–µ–µ'):
                    w = w[:-2]
                elif w.endswith('–∞–º') or w.endswith('—è–º'):
                    w = w[:-2]
                elif w.endswith('–∞–º–∏') or w.endswith('—è–º–∏'):
                    w = w[:-3]
                elif w.endswith('–∞—Ö') or w.endswith('—è—Ö'):
                    w = w[:-2]
                elif w.endswith('–æ–≤') or w.endswith('–µ–≤'):
                    w = w[:-2]
                elif w.endswith('–µ–π'):
                    w = w[:-2]
            normalized.append(w)

        return ' '.join(normalized)

    # ------------------------------------------------------------
    #  –ü–û–õ–£–ß–ï–ù–ò–ï –ö–ê–ù–î–ò–î–ê–¢–û–í –ß–ï–†–ï–ó –ò–ù–í–ï–†–¢–ò–†–û–í–ê–ù–ù–´–ô –ò–ù–î–ï–ö–°
    # ------------------------------------------------------------
    def _get_candidates(self, norm_query: str, max_candidates: int = 20) -> List[FAQEntry]:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ TF (–≤–µ—Å –≤–æ–ø—Ä–æ—Å–∞ > –≤–µ—Å –∫–ª—é—á–µ–π)."""
        if not norm_query:
            return []

        words = norm_query.split()
        if not words:
            return []

        # –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ —Å–ª–æ–≤–æ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞
        candidate_set = set()
        for w in words:
            candidate_set.update(self._inverted_index.get(w, []))

        if not candidate_set:
            # –ï—Å–ª–∏ –∏–Ω–¥–µ–∫—Å –ø—É—Å—Ç, –±–µ—Ä—ë–º –ø–µ—Ä–≤—ã–µ N –∑–∞–ø–∏—Å–µ–π –∫–∞–∫ fallback
            return self.faq_data[:max_candidates]

        # –û—Ü–µ–Ω–∏–≤–∞–µ–º TF —Å –≤–µ—Å–∞–º–∏
        scored = []
        for faq in candidate_set:
            score = 0.0
            # –í–µ—Å –¥–ª—è –≤–æ–ø—Ä–æ—Å–∞ –≤—ã—à–µ
            if faq.norm_question:
                q_words = set(faq.norm_question.split())
                common_q = set(words) & q_words
                score += len(common_q) * 2.0
            if faq.norm_keywords:
                kw_words = set(faq.norm_keywords.split())
                common_kw = set(words) & kw_words
                score += len(common_kw) * 1.0
            scored.append((faq, score))

        scored.sort(key=lambda x: x[1], reverse=True)
        return [faq for faq, _ in scored[:max_candidates]]

    # ------------------------------------------------------------
    #  –ü–û–õ–ù–´–ô –†–ê–°–ß–Å–¢ –†–ï–õ–ï–í–ê–ù–¢–ù–û–°–¢–ò (–° TF‚ÄëIDF –ò –õ–ï–í–ï–ù–®–¢–ï–ô–ù–û–ú)
    # ------------------------------------------------------------
    def _calculate_full_score(self, norm_query: str, query_words: Set[str], faq: FAQEntry) -> float:
        score = 0.0

        # 1. –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
        if norm_query == faq.norm_question:
            return 100.0

        # 2. –ó–∞–ø—Ä–æ—Å —è–≤–ª—è–µ—Ç—Å—è –ø–æ–¥—Å—Ç—Ä–æ–∫–æ–π –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
        if norm_query in faq.norm_question:
            score += 50.0

        # 3. –ù–µ—á—ë—Ç–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ (–õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω) —Å –ø–æ—Ä–æ–≥–æ–º
        if len(norm_query) >= 4 and faq.norm_question:
            lev_dist = levenshtein_distance(norm_query, faq.norm_question, threshold=4)
            if lev_dist == 0:
                return 100.0
            elif lev_dist <= 2:
                score += 40.0
            elif lev_dist <= 4:
                score += 20.0
            if faq.norm_keywords:
                kw_lev = levenshtein_distance(norm_query, faq.norm_keywords[:len(norm_query)+5], threshold=4)
                if kw_lev <= 2:
                    score += 30.0

        # 4. –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ –ø–æ —Å–ª–æ–≤–∞–º –≤ –≤–æ–ø—Ä–æ—Å–µ —Å —É—á—ë—Ç–æ–º IDF
        if faq.norm_question:
            q_words = set(faq.norm_question.split())
            common_q = query_words & q_words
            for w in common_q:
                score += self._idf_cache.get(w, 1.0) * 12.0

        # 5. –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º —Å —É—á—ë—Ç–æ–º IDF
        if faq.norm_keywords:
            kw_words = set(faq.norm_keywords.split())
            common_kw = query_words & kw_words
            for w in common_kw:
                score += self._idf_cache.get(w, 1.0) * 20.0

        # 6. –ß–∞—Å—Ç–∏—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–ª–æ–≤ (–≤—Ö–æ–∂–¥–µ–Ω–∏–µ)
        for word in query_words:
            if len(word) > 3:
                if word in faq.norm_question:
                    score += self._idf_cache.get(word, 1.0) * 3.0
                if faq.norm_keywords and word in faq.norm_keywords:
                    score += self._idf_cache.get(word, 1.0) * 5.0

        return min(score, 100.0)

    # ------------------------------------------------------------
    #  –û–°–ù–û–í–ù–û–ô –ü–û–ò–°–ö
    # ------------------------------------------------------------
    def search(self, query: str, category: Optional[str] = None, top_k: int = 5) -> List[Tuple[str, str, float]]:
        if not query or len(query.strip()) < 2:
            return []
        if not self.faq_data:
            logger.warning("‚ö†Ô∏è –ü–æ–∏—Å–∫ –ø—Ä–∏ –ø—É—Å—Ç–æ–π –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π")
            return []

        norm_query = self._normalize_text(query)
        if not norm_query:
            return []

        cache_key = f"{norm_query}_{category}_{top_k}"
        cache_key_hash = hashlib.md5(cache_key.encode()).hexdigest()[:16]

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—ç—à–∞ (TTL 30 –º–∏–Ω—É—Ç)
        if cache_key_hash in self.cache:
            expiry = self.cache_ttl.get(cache_key_hash)
            if expiry and datetime.now() < expiry:
                self.stats['cache_hits'] += 1
                self.stats['total_searches'] += 1
                self.cache.move_to_end(cache_key_hash)
                return self.cache[cache_key_hash]

        self.stats['total_searches'] += 1
        self.stats['cache_misses'] += 1

        # –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–Ω–µ—á—ë—Ç–∫–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ)
        faq_list = self._filter_by_category(category) if category else self.faq_data
        if not faq_list:
            return []

        query_words = set(norm_query.split())
        # –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —á–∏—Å–ª–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¥–ª–∏–Ω—ã –∑–∞–ø—Ä–æ—Å–∞
        max_candidates = 25 if len(query_words) <= 3 else 15
        candidates = self._get_candidates(norm_query, max_candidates)

        # –ï—Å–ª–∏ candidates –ø—É—Å—Ç –∏–ª–∏ —Å–ª–∏—à–∫–æ–º –º–∞–ª–æ, –±–µ—Ä—ë–º –ø–µ—Ä–≤—ã–µ N –∏–∑ faq_list
        if len(candidates) < 3:
            candidates = faq_list[:20]

        # –ü–æ–ª–Ω—ã–π —Ä–∞—Å—á—ë—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –¥–ª—è –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
        results = []
        for faq in candidates:
            score = self._calculate_full_score(norm_query, query_words, faq)
            if score > 0:
                results.append((faq.question, faq.answer, score))

        results.sort(key=lambda x: x[2], reverse=True)
        top_results = results[:top_k]

        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∫—ç—à
        if top_results:
            if len(self.cache) >= self.max_cache_size:
                oldest = next(iter(self.cache))
                del self.cache[oldest]
                del self.cache_ttl[oldest]
            self.cache[cache_key_hash] = top_results
            self.cache_ttl[cache_key_hash] = datetime.now() + timedelta(minutes=30)  # TTL 30 –º–∏–Ω—É—Ç

        return top_results

    def _filter_by_category(self, category: str) -> List[FAQEntry]:
        """–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å –Ω–µ—á—ë—Ç–∫–∏–º —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ–º."""
        cat_lower = category.lower().strip()
        # –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
        if cat_lower in self._category_index:
            return self._category_index[cat_lower]

        # –ß–∞—Å—Ç–∏—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ (–≤—Ö–æ–∂–¥–µ–Ω–∏–µ)
        for stored_cat, entries in self._category_index.items():
            if cat_lower in stored_cat or stored_cat in cat_lower:
                logger.debug(f"–ß–∞—Å—Ç–∏—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: '{category}' -> '{stored_cat}'")
                return entries

        # –ù–µ—á—ë—Ç–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ (–õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω) –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π
        best_dist = 3
        best_entries = []
        for stored_cat, entries in self._category_index.items():
            if len(cat_lower) >= 3 and len(stored_cat) >= 3:
                dist = levenshtein_distance(cat_lower, stored_cat, threshold=3)
                if dist < best_dist:
                    best_dist = dist
                    best_entries = entries
        if best_entries:
            return best_entries

        return []

    # ------------------------------------------------------------
    #  –ü–†–ï–î–õ–û–ñ–ï–ù–ò–Ø –ü–û –ò–°–ü–†–ê–í–õ–ï–ù–ò–Æ –ó–ê–ü–†–û–°–ê
    # ------------------------------------------------------------
    def suggest_correction(self, query: str, top_k: int = 3) -> List[str]:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤–æ–ø—Ä–æ—Å–æ–≤, –Ω–∞–∏–±–æ–ª–µ–µ –±–ª–∏–∑–∫–∏—Ö –∫ –∑–∞–ø—Ä–æ—Å—É."""
        if not query or not self.faq_data:
            return []

        norm_query = self._normalize_text(query)
        if not norm_query or len(norm_query) < 3:
            return []

        candidates = []
        for faq in self.faq_data[:50]:  # –û–≥—Ä–∞–Ω–∏—á–∏–º –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏
            if faq.norm_question:
                dist = levenshtein_distance(norm_query, faq.norm_question, threshold=5)
                if dist <= 5:
                    candidates.append((faq.question, dist))

        candidates.sort(key=lambda x: x[1])
        return [q for q, _ in candidates[:top_k]]

    # ------------------------------------------------------------
    #  –û–ë–ù–û–í–õ–ï–ù–ò–ï –î–ê–ù–ù–´–•
    # ------------------------------------------------------------
    def refresh_data(self):
        """–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ faq.json –∏ –ø–µ—Ä–µ—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω–¥–µ–∫—Å–æ–≤."""
        self._load_faq()
        self._build_indexes()
        self.cache.clear()
        self.cache_ttl.clear()
        logger.info("üîÑ –î–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω—ã, –∏–Ω–¥–µ–∫—Å—ã –ø–µ—Ä–µ—Å—Ç—Ä–æ–µ–Ω—ã, –∫—ç—à —Å–±—Ä–æ—à–µ–Ω")

    # ------------------------------------------------------------
    #  –°–¢–ê–¢–ò–°–¢–ò–ö–ê
    # ------------------------------------------------------------
    def get_stats(self) -> Dict[str, Any]:
        categories = {}
        for faq in self.faq_data:
            categories[faq.category] = categories.get(faq.category, 0) + 1

        cache_hit_rate = 0.0
        if self.stats['total_searches'] > 0:
            cache_hit_rate = (self.stats['cache_hits'] / self.stats['total_searches']) * 100

        return {
            'faq_count': len(self.faq_data),
            'categories': len(categories),
            'category_list': sorted(categories.keys()),
            'category_counts': categories,
            'inverted_index_size': len(self._inverted_index),
            'cache_size': len(self.cache),
            'max_cache_size': self.max_cache_size,
            'total_searches': self.stats['total_searches'],
            'cache_hits': self.stats['cache_hits'],
            'cache_misses': self.stats['cache_misses'],
            'cache_hit_rate': round(cache_hit_rate, 2),
            'loaded_from': self.stats['loaded_from']
        }

    def get_faq_by_id(self, faq_id: int) -> Optional[Dict]:
        for faq in self.faq_data:
            if faq.id == faq_id:
                return {
                    'id': faq.id,
                    'question': faq.question,
                    'answer': faq.answer,
                    'category': faq.category,
                    'keywords': faq.keywords
                }
        return None


# –î–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
EnhancedSearchEngine = SearchEngine
